











<!-- Added the smart search feature -->







<!-- <!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Found Items ‚Äî Smart Lost & Found</title>
    <link rel="stylesheet" href="styles.css" />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    <style>
      /* FILTER BAR STYLE */
      .filter-container {
        display: flex; gap: 10px; margin-bottom: 20px; flex-wrap: wrap;
        background: #f9fafb; padding: 15px; border-radius: 12px; border: 1px solid #e5e7eb;
      }
      .filter-select {
        padding: 10px; border: 1px solid #d1d5db; border-radius: 8px;
        background-color: white; font-size: 0.9rem; color: #374151; cursor: pointer;
        flex: 1; min-width: 140px;
      }
      /* SEARCH BAR STYLE */
      .search-input {
        flex: 2; min-width: 200px; padding: 10px; border: 1px solid #d1d5db; 
        border-radius: 8px; font-size: 0.9rem;
      }

      /* GRID & CARD STYLES */
      .item-grid {
        display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
        gap: 20px;
      }
      .card {
        background: white; border: 1px solid #e5e7eb; border-radius: 12px;
        overflow: hidden; transition: transform 0.2s; box-shadow: 0 4px 6px rgba(0,0,0,0.05);
        display: flex; flex-direction: column;
      }
      .card:hover { transform: translateY(-3px); }
      .card-img { width: 100%; height: 180px; object-fit: cover; background: #f3f4f6; }
      .card-body { padding: 15px; flex-grow: 1; display: flex; flex-direction: column;}
      
      .category-badge {
        background-color: #dbeafe; color: #1e40af; padding: 5px 12px; border-radius: 9999px; 
        font-size: 0.75rem; font-weight: 700; text-transform: uppercase; 
        display: inline-block; margin-bottom: 10px; border: 1px solid #bfdbfe; width: fit-content;
      }
      
      h3 { margin: 0 0 5px 0; color: #111; }
      p { margin: 5px 0; color: #555; font-size: 0.9rem; }
      .time-ago { font-size: 0.75rem; color: #9ca3af; margin-bottom: 8px; display: block; }
      .contact-box { margin-top: auto; padding-top: 10px; border-top: 1px solid #eee; font-weight: 500; color: #2563eb; }
      
      .delete-btn {
        background-color: #fde8e8; color: #c53030; border: 1px solid #cbd5e1;
        padding: 8px; border-radius: 6px; font-size: 0.85rem; font-weight: 600;
        cursor: pointer; margin-top: 10px; width: 100%; text-align: center;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <header><h2>Recently Found Items</h2></header>

      <div class="filter-container">
        <input type="text" id="searchInput" class="search-input" placeholder="üîç Search (e.g. 'Black Bag')..." />
        
        <select id="categoryFilter" class="filter-select">
          <option value="All">All Categories</option>
          <option value="Electronics">Electronics</option>
          <option value="ID Card">ID Card</option>
          <option value="Notebook">Notebook</option>
          <option value="Accessory">Accessory</option>
          <option value="Other">Other</option>
        </select>
        
        <select id="sortFilter" class="filter-select">
          <option value="newest">Newest First</option>
          <option value="oldest">Oldest First</option>
        </select>
      </div>

      <div id="loading" style="text-align: center; color: #666; margin-top: 20px;">Loading items...</div>
      <div id="itemsGrid" class="item-grid"></div>

      <p style="margin-top: 30px;"><a href="index.html" class="btn" style="background-color: var(--text-muted);">Back to Home</a></p>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
        import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-auth.js";
        import { getFirestore, collection, query, where, getDocs, orderBy, deleteDoc, doc } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyBHqbuwOBlJBix9SgLFqYSLqFlXs7Uqup8",
            authDomain: "lost-and-found-17d0e.firebaseapp.com",
            projectId: "lost-and-found-17d0e",
            messagingSenderId: "746918449748",
            appId: "1:746918449748:web:6de9b7b1a1a68ae91f13c1"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);
        let currentUser = null;

        onAuthStateChanged(auth, (user) => {
            currentUser = user;
            loadItems();
        });

        function timeAgo(date) {
            const seconds = Math.floor((new Date() - date) / 1000);
            let interval = seconds / 31536000;
            if (interval > 1) return Math.floor(interval) + " years ago";
            interval = seconds / 2592000;
            if (interval > 1) return Math.floor(interval) + " months ago";
            interval = seconds / 86400;
            if (interval > 1) return Math.floor(interval) + " days ago";
            interval = seconds / 3600;
            if (interval > 1) return Math.floor(interval) + " hours ago";
            interval = seconds / 60;
            if (interval > 1) return Math.floor(interval) + " mins ago";
            return "Just now";
        }

        window.deleteItem = async (itemId) => {
            if (confirm("Are you sure you want to delete this?")) {
                try {
                    await deleteDoc(doc(db, "items", itemId));
                    alert("Item removed!");
                    location.reload(); 
                } catch (error) { alert("Error: " + error.message); }
            }
        };

        // --- SMART SEARCH & FILTER LOGIC ---
        function applyFilters() {
            // 1. Get Text & Split into Words (e.g. "black bag" -> ["black", "bag"])
            const rawText = document.getElementById('searchInput').value.toLowerCase().trim();
            const searchTerms = rawText.split(/\s+/); // Splits by space

            const catFilter = document.getElementById('categoryFilter').value;
            const sortFilter = document.getElementById('sortFilter').value;
            const grid = document.getElementById('itemsGrid');
            const cards = Array.from(grid.children);

            cards.forEach(card => {
                const cardName = card.getAttribute('data-name').toLowerCase();
                const cardCat = card.getAttribute('data-category');
                
                // 2. Smart Check: Does the card contain EVERY word from the search?
                // If search is empty (length 1 but empty string), we treat as match
                const matchesSearch = (rawText === "") || searchTerms.every(term => cardName.includes(term));
                
                const matchesCat = (catFilter === 'All' || cardCat === catFilter);

                if (matchesSearch && matchesCat) {
                    card.style.display = 'flex';
                } else {
                    card.style.display = 'none';
                }
            });

            // 3. Sort Logic
            cards.sort((a, b) => {
                const timeA = parseInt(a.getAttribute('data-time'));
                const timeB = parseInt(b.getAttribute('data-time'));
                return sortFilter === 'newest' ? timeB - timeA : timeA - timeB;
            });

            cards.forEach(card => grid.appendChild(card));
        }

        // Listeners
        document.getElementById('searchInput').addEventListener('keyup', applyFilters);
        document.getElementById('categoryFilter').addEventListener('change', applyFilters);
        document.getElementById('sortFilter').addEventListener('change', applyFilters);

        async function loadItems() {
            const grid = document.getElementById('itemsGrid');
            const loadingDiv = document.getElementById('loading');

            try {
                const q = query(collection(db, "items"), where("type", "==", "found"), orderBy("timestamp", "desc"));
                const querySnapshot = await getDocs(q);
                loadingDiv.style.display = 'none';

                if (querySnapshot.empty) {
                    grid.innerHTML = '<p style="grid-column: 1/-1; text-align:center;">No found items yet.</p>';
                    return;
                }

                grid.innerHTML = '';
                querySnapshot.forEach((doc) => {
                    const data = doc.data();
                    const card = document.createElement('div');
                    card.className = 'card';
                    
                    // SMART ICONS
                    let icon = "üì¶";
                    if (data.category === "Electronics") icon = "üíª";
                    if (data.category === "ID Card") icon = "ü™™";
                    if (data.category === "Notebook") icon = "üìö";
                    if (data.category === "Accessory") icon = "üï∂Ô∏è";

                    // STORE DATA FOR SEARCH (Combine Name + Desc)
                    card.setAttribute('data-name', data.item_name + " " + data.description);
                    card.setAttribute('data-category', data.category);
                    const timeNum = data.timestamp ? data.timestamp.seconds : 0;
                    card.setAttribute('data-time', timeNum);

                    const contact = data.contact_info || "Not Provided";
                    let timeString = data.timestamp ? timeAgo(data.timestamp.toDate()) : "Unknown";

                    let deleteBtnHTML = "";
                    if (currentUser && data.owner === currentUser.uid) {
                        deleteBtnHTML = `<button onclick="window.deleteItem('${doc.id}')" class="delete-btn">‚úÖ Mark Resolved</button>`;
                    }

                    card.innerHTML = `
                        <img src="${data.imageURL}" class="card-img" alt="Item" onerror="this.src='https://placehold.co/400x300?text=No+Image'">
                        <div class="card-body">
                            <span class="category-badge">${icon} ${data.category}</span>
                            <span class="time-ago">üïí Posted ${timeString}</span>
                            <h3>${data.item_name}</h3>
                            <p>${data.description}</p>
                            <p><strong>Location:</strong> ${data.location}</p>
                            <div class="contact-box">üìû Contact: ${contact} ${deleteBtnHTML}</div>
                        </div>
                    `;
                    grid.appendChild(card);
                });

                // CHECK FOR HOME PAGE SEARCH REDIRECT
                const params = new URLSearchParams(window.location.search);
                const searchParam = params.get('search');
                if (searchParam) {
                    const searchInput = document.getElementById('searchInput');
                    searchInput.value = searchParam;
                    applyFilters(); // Trigger filter immediately
                }

            } catch (error) {
                console.error(error);
                loadingDiv.innerText = "Error loading items.";
            }
        }
    </script>
  </body>
</html> -->
















<!-- designing code -->


















<!-- <!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Found Items ‚Äî Smart Lost & Found</title>
    <link rel="stylesheet" href="styles.css" />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    <style>
      .item-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 20px; }
      .card-body { padding: 15px; flex-grow: 1; display: flex; flex-direction: column; }
      
      .category-badge {
        background-color: #dbeafe; color: #1e40af; padding: 5px 12px; border-radius: 9999px; 
        font-size: 0.75rem; font-weight: 700; text-transform: uppercase; 
        display: inline-block; margin-bottom: 10px; border: 1px solid #bfdbfe; width: fit-content;
      }
      
      .time-ago { font-size: 0.75rem; color: #9ca3af; margin-bottom: 8px; display: block; }
      .contact-box { margin-top: auto; padding-top: 10px; border-top: 1px solid #eee; font-weight: 500; color: #2563eb; }
      
      .delete-btn {
        background-color: #fde8e8; color: #c53030; border: 1px solid #cbd5e1;
        padding: 8px; border-radius: 6px; font-size: 0.85rem; font-weight: 600;
        cursor: pointer; margin-top: 10px; width: 100%; text-align: center;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <header><h2>Recently Found Items</h2></header>

      <div class="filter-container">
        <input type="text" id="searchInput" class="search-input" placeholder="üîç Search (e.g. 'Black Bag')..." />
        <select id="categoryFilter" class="filter-select">
          <option value="All">All Categories</option>
          <option value="Electronics">Electronics</option>
          <option value="ID Card">ID Card</option>
          <option value="Notebook">Notebook</option>
          <option value="Accessory">Accessory</option>
          <option value="Other">Other</option>
        </select>
        <select id="sortFilter" class="filter-select">
          <option value="newest">Newest First</option>
          <option value="oldest">Oldest First</option>
        </select>
      </div>

      <div id="loading" style="text-align: center; color: #666; margin-top: 20px;">Loading items...</div>
      <div id="itemsGrid" class="item-grid"></div>

      <p style="margin-top: 30px;"><a href="index.html" class="btn" style="background-color: var(--text-muted);">Back to Home</a></p>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
        import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-auth.js";
        import { getFirestore, collection, query, where, getDocs, orderBy, deleteDoc, doc } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyBHqbuwOBlJBix9SgLFqYSLqFlXs7Uqup8",
            authDomain: "lost-and-found-17d0e.firebaseapp.com",
            projectId: "lost-and-found-17d0e",
            messagingSenderId: "746918449748",
            appId: "1:746918449748:web:6de9b7b1a1a68ae91f13c1"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);
        let currentUser = null;

        onAuthStateChanged(auth, (user) => { currentUser = user; loadItems(); });

        function timeAgo(date) {
            const seconds = Math.floor((new Date() - date) / 1000);
            let interval = seconds / 31536000;
            if (interval > 1) return Math.floor(interval) + " years ago";
            interval = seconds / 2592000;
            if (interval > 1) return Math.floor(interval) + " months ago";
            interval = seconds / 86400;
            if (interval > 1) return Math.floor(interval) + " days ago";
            interval = seconds / 3600;
            if (interval > 1) return Math.floor(interval) + " hours ago";
            interval = seconds / 60;
            if (interval > 1) return Math.floor(interval) + " mins ago";
            return "Just now";
        }

        window.deleteItem = async (itemId) => {
            if (confirm("Are you sure you want to mark this as resolved?")) {
                try {
                    await deleteDoc(doc(db, "items", itemId));
                    alert("Item marked as resolved!");
                    location.reload(); 
                } catch (error) { alert("Error: " + error.message); }
            }
        };

        function applyFilters() {
            const rawText = document.getElementById('searchInput').value.toLowerCase().trim();
            const searchTerms = rawText.split(/\s+/);
            const catFilter = document.getElementById('categoryFilter').value;
            const sortFilter = document.getElementById('sortFilter').value;
            const grid = document.getElementById('itemsGrid');
            const cards = Array.from(grid.children);

            cards.forEach(card => {
                const cardName = card.getAttribute('data-name').toLowerCase();
                const cardCat = card.getAttribute('data-category');
                const matchesSearch = (rawText === "") || searchTerms.every(term => cardName.includes(term));
                const matchesCat = (catFilter === 'All' || cardCat === catFilter);
                card.style.display = (matchesSearch && matchesCat) ? 'flex' : 'none';
            });

            cards.sort((a, b) => {
                const timeA = parseInt(a.getAttribute('data-time'));
                const timeB = parseInt(b.getAttribute('data-time'));
                return sortFilter === 'newest' ? timeB - timeA : timeA - timeB;
            });

            cards.forEach(card => grid.appendChild(card));
        }

        document.getElementById('searchInput').addEventListener('keyup', applyFilters);
        document.getElementById('categoryFilter').addEventListener('change', applyFilters);
        document.getElementById('sortFilter').addEventListener('change', applyFilters);

        async function loadItems() {
            const grid = document.getElementById('itemsGrid');
            const loadingDiv = document.getElementById('loading');
            try {
                const q = query(collection(db, "items"), where("type", "==", "found"), orderBy("timestamp", "desc"));
                const querySnapshot = await getDocs(q);
                loadingDiv.style.display = 'none';

                if (querySnapshot.empty) { grid.innerHTML = '<p style="grid-column: 1/-1; text-align:center;">No items found.</p>'; return; }

                grid.innerHTML = '';
                querySnapshot.forEach((doc) => {
                    const data = doc.data();
                    const card = document.createElement('div');
                    card.className = 'card';
                    
                    let icon = "üì¶";
                    if (data.category === "Electronics") icon = "üíª";
                    if (data.category === "ID Card") icon = "ü™™";
                    if (data.category === "Notebook") icon = "üìö";
                    if (data.category === "Accessory") icon = "üï∂Ô∏è";

                    card.setAttribute('data-name', data.item_name + " " + data.description);
                    card.setAttribute('data-category', data.category);
                    card.setAttribute('data-time', data.timestamp ? data.timestamp.seconds : 0);

                    const contact = data.contact_info || "Not Provided";
                    let timeString = data.timestamp ? timeAgo(data.timestamp.toDate()) : "Unknown";

                    let deleteBtnHTML = "";
                    if (currentUser && data.owner === currentUser.uid) {
                        deleteBtnHTML = `<button onclick="window.deleteItem('${doc.id}')" class="delete-btn">‚úÖ Mark Resolved</button>`;
                    }

                    card.innerHTML = `
                        <img src="${data.imageURL}" class="card-img" alt="Item" onerror="this.src='https://placehold.co/400x300?text=No+Image'">
                        <div class="card-body">
                            <span class="category-badge">${icon} ${data.category}</span>
                            <span class="time-ago">üïí Posted ${timeString}</span>
                            <h3>${data.item_name}</h3>
                            <p>${data.description}</p>
                            <p><strong>Location:</strong> ${data.location}</p>
                            <div class="contact-box">üìû Contact: ${contact} ${deleteBtnHTML}</div>
                        </div>
                    `;
                    grid.appendChild(card);
                });

                const params = new URLSearchParams(window.location.search);
                const searchParam = params.get('search');
                if (searchParam) {
                    document.getElementById('searchInput').value = searchParam;
                    applyFilters();
                }

            } catch (error) { console.error(error); loadingDiv.innerText = "Error loading items."; }
        }
    </script>
  </body>
</html> -->































<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Found Items ‚Äî Smart Lost & Found</title>
    <link rel="stylesheet" href="styles.css" />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    <style>
      .item-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 20px; }
      .card-body { padding: 15px; flex-grow: 1; display: flex; flex-direction: column; }
      
      .category-badge {
        background-color: #dbeafe; color: #1e40af; padding: 5px 12px; border-radius: 9999px; 
        font-size: 0.75rem; font-weight: 700; text-transform: uppercase; 
        display: inline-block; margin-bottom: 10px; border: 1px solid #bfdbfe; width: fit-content;
      }
      
      .time-ago { font-size: 0.75rem; color: #9ca3af; margin-bottom: 8px; display: block; }
      .contact-box { margin-top: auto; padding-top: 10px; border-top: 1px solid #eee; font-weight: 500; color: #2563eb; }
      
      .delete-btn {
        background-color: #fde8e8; color: #c53030; border: 1px solid #cbd5e1;
        padding: 8px; border-radius: 6px; font-size: 0.85rem; font-weight: 600;
        cursor: pointer; margin-top: 10px; width: 100%; text-align: center;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <header><h2>Recently Found Items</h2></header>

      <div class="filter-container">
        <input type="text" id="searchInput" class="search-input" placeholder="üîç Search (e.g. 'Black Bag')..." />
        <select id="categoryFilter" class="filter-select">
          <option value="All">All Categories</option>
          <option value="Electronics">Electronics</option>
          <option value="ID Card">ID Card</option>
          <option value="Notebook">Notebook</option>
          <option value="Accessory">Accessory</option>
          <option value="Other">Other</option>
        </select>
        <select id="sortFilter" class="filter-select">
          <option value="newest">Newest First</option>
          <option value="oldest">Oldest First</option>
        </select>
      </div>

      <div id="loading" style="text-align: center; color: #666; margin-top: 20px;">Loading items...</div>
      <div id="itemsGrid" class="item-grid"></div>

      <p style="margin-top: 30px;"><a href="index.html" class="btn" style="background-color: var(--text-muted);">Back to Home</a></p>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
        import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-auth.js";
        import { getFirestore, collection, query, where, getDocs, orderBy, deleteDoc, doc } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyBHqbuwOBlJBix9SgLFqYSLqFlXs7Uqup8",
            authDomain: "lost-and-found-17d0e.firebaseapp.com",
            projectId: "lost-and-found-17d0e",
            messagingSenderId: "746918449748",
            appId: "1:746918449748:web:6de9b7b1a1a68ae91f13c1"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);
        let currentUser = null;

        onAuthStateChanged(auth, (user) => { currentUser = user; loadItems(); });

        function timeAgo(date) {
            const seconds = Math.floor((new Date() - date) / 1000);
            let interval = seconds / 31536000;
            if (interval > 1) return Math.floor(interval) + " years ago";
            interval = seconds / 2592000;
            if (interval > 1) return Math.floor(interval) + " months ago";
            interval = seconds / 86400;
            if (interval > 1) return Math.floor(interval) + " days ago";
            interval = seconds / 3600;
            if (interval > 1) return Math.floor(interval) + " hours ago";
            interval = seconds / 60;
            if (interval > 1) return Math.floor(interval) + " mins ago";
            return "Just now";
        }

        window.deleteItem = async (itemId) => {
            if (confirm("Are you sure you want to mark this as resolved?")) {
                try {
                    await deleteDoc(doc(db, "items", itemId));
                    alert("Item marked as resolved!");
                    location.reload(); 
                } catch (error) { alert("Error: " + error.message); }
            }
        };

        function applyFilters() {
            const rawText = document.getElementById('searchInput').value.toLowerCase().trim();
            const searchTerms = rawText.split(/\s+/);
            const catFilter = document.getElementById('categoryFilter').value;
            const sortFilter = document.getElementById('sortFilter').value;
            const grid = document.getElementById('itemsGrid');
            const cards = Array.from(grid.children);

            cards.forEach(card => {
                const cardName = card.getAttribute('data-name').toLowerCase();
                const cardCat = card.getAttribute('data-category');
                const matchesSearch = (rawText === "") || searchTerms.every(term => cardName.includes(term));
                const matchesCat = (catFilter === 'All' || cardCat === catFilter);
                card.style.display = (matchesSearch && matchesCat) ? 'flex' : 'none';
            });

            cards.sort((a, b) => {
                const timeA = parseInt(a.getAttribute('data-time'));
                const timeB = parseInt(b.getAttribute('data-time'));
                return sortFilter === 'newest' ? timeB - timeA : timeA - timeB;
            });

            cards.forEach(card => grid.appendChild(card));
        }

        document.getElementById('searchInput').addEventListener('keyup', applyFilters);
        document.getElementById('categoryFilter').addEventListener('change', applyFilters);
        document.getElementById('sortFilter').addEventListener('change', applyFilters);

        async function loadItems() {
            const grid = document.getElementById('itemsGrid');
            const loadingDiv = document.getElementById('loading');
            try {
                const q = query(collection(db, "items"), where("type", "==", "found"), orderBy("timestamp", "desc"));
                const querySnapshot = await getDocs(q);
                loadingDiv.style.display = 'none';

                if (querySnapshot.empty) { grid.innerHTML = '<p style="grid-column: 1/-1; text-align:center;">No items found.</p>'; return; }

                grid.innerHTML = '';
                querySnapshot.forEach((doc) => {
                    const data = doc.data();
                    const card = document.createElement('div');
                    card.className = 'card';
                    
                    let icon = "üì¶";
                    if (data.category === "Electronics") icon = "üíª";
                    if (data.category === "ID Card") icon = "ü™™";
                    if (data.category === "Notebook") icon = "üìö";
                    if (data.category === "Accessory") icon = "üï∂Ô∏è";

                    card.setAttribute('data-name', data.item_name + " " + data.description);
                    card.setAttribute('data-category', data.category);
                    card.setAttribute('data-time', data.timestamp ? data.timestamp.seconds : 0);

                    const contact = data.contact_info || "Not Provided";
                    let timeString = data.timestamp ? timeAgo(data.timestamp.toDate()) : "Unknown";

                    let deleteBtnHTML = "";
                    if (currentUser && data.owner === currentUser.uid) {
                        deleteBtnHTML = `<button onclick="window.deleteItem('${doc.id}')" class="delete-btn">‚úÖ Mark Resolved</button>`;
                    }

                    card.innerHTML = `
                        <img src="${data.imageURL}" class="card-img" alt="Item" onerror="this.src='https://placehold.co/400x300?text=No+Image'">
                        <div class="card-body">
                            <span class="category-badge">${icon} ${data.category}</span>
                            <span class="time-ago">üïí Posted ${timeString}</span>
                            <h3>${data.item_name}</h3>
                            <p>${data.description}</p>
                            <p><strong>Location:</strong> ${data.location}</p>
                            <div class="contact-box">üìû Contact: ${contact} ${deleteBtnHTML}</div>
                        </div>
                    `;
                    grid.appendChild(card);
                });

                const params = new URLSearchParams(window.location.search);
                const searchParam = params.get('search');
                if (searchParam) {
                    document.getElementById('searchInput').value = searchParam;
                    applyFilters();
                }
            } catch (error) { console.error(error); loadingDiv.innerText = "Error loading items."; }
        }
    </script>
  </body>
</html>